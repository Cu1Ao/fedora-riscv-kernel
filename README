This is the sifive_u540 branch which contains changes for the
SiFive HiFive Unleashed U540 board with an NFS root filesystem.

The Linux kernel for the Fedora/RISC-V project.
https://fedoraproject.org/wiki/Architectures/RISC-V

This is NOT the Linux kernel itself.  It is the build script and a few
patches which we use to build the Linux kernel for the Fedora/RISC-V
project.

The actual Linux kernel source comes from the following fork:
https://github.com/riscv/riscv-linux

NB: This must be run on an existing Fedora/RISC-V build host or VM.
It cannot be cross-compiled.

Requirements:

 - Fedora/RISC-V
   see: https://fedoraproject.org/wiki/Architectures/RISC-V
        https://fedorapeople.org/groups/risc-v/disk-images/

 - Install the kernel dependencies into the VM environment.  One
   way is to run 'dnf builddep kernel.spec'

You must set up an NFSv3 server, serving the stage4-disk.img from
https://fedorapeople.org/groups/risc-v/disk-images/

Inside the disk image (ie. NFS root filesystem) you have to mask the
network service, since networking is set up by the kernel.  Do:
  cd /mnt/riscv/etc/systemd/system
  ln -s /dev/null systemd-networkd.service

In this Makefile you must set the variable (NFSROOT) to match your NFS
server.

Build the kernel:

 - Run 'make'

The result is the 'bbl.u540' file.  Note we do not use modules.

Test the kernel:

 - Get a stage4 disk image, for example from
   https://fedorapeople.org/groups/risc-v/

 - Get qemu-system-riscv64.

 - Run 'make boot-stage4-in-qemu'

Boot on the real hardware:

 - Copy bbl.u540 over the first partition of the SD card.
